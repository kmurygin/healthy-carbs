<div class="mx-auto max-w-7xl px-4 py-8 min-h-screen">

  <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8">
    <div class="flex items-center gap-4">
      <div>
        <h2 class="text-2xl font-bold text-gray-900 tracking-tight">User Management</h2>
        <p class="text-gray-500 text-sm">Manage all users in the system</p>
      </div>
    </div>
  </div>

  <app-user-filter
    (filterChange)="handleFiltersChange($event)"
    [roles]="roles"
    class="mb-6 block"
  />

  @if (isDataLoading()) {
    <div class="flex flex-col items-center justify-center gap-3 p-12 text-gray-500">
      <fa-icon [icon]="icons.spinner" class="text-3xl text-emerald-600 animate-spin"></fa-icon>
      <p class="font-medium animate-pulse">Loading users...</p>
    </div>
  } @else if (error()) {
    <div class="p-4 rounded-xl bg-red-50 border border-red-100 text-red-600 flex items-center gap-3">
      <fa-icon [icon]="icons.warn"></fa-icon>
      {{ error() }}
    </div>
  } @else if (totalElements() === 0) {
    <div class="flex flex-col items-center justify-center gap-3 p-16 text-gray-400
      bg-white rounded-2xl border border-gray-200 border-dashed">
      <fa-icon [icon]="icons.users" class="text-4xl mb-2"></fa-icon>
      <p class="text-lg font-medium text-gray-600">No users found.</p>
      <p class="text-sm">Users will appear here once they register.</p>
    </div>
  } @else {
    <app-user-management-mobile-list
      (delete)="deleteItem($event.id)"
      (toggleActive)="toggleUserActive($event)"
      (viewDetails)="viewUserDetails($event)"
      [users]="filteredUsers()"
    ></app-user-management-mobile-list>

    <app-user-management-table
      (changeRole)="changeUserRole($event)"
      (delete)="deleteItem($event.id)"
      (toggleActive)="toggleUserActive($event)"
      (viewDetails)="viewUserDetails($event)"
      [assignableRoles]="assignableRoles"
      [users]="filteredUsers()"
    ></app-user-management-table>

    <div class="mt-6 px-4 py-3">
      <p class="text-sm text-gray-500">
        Showing {{ filteredUsers().length }} of {{ totalElements() }} users
      </p>
    </div>
  }

  @if (selectedUser(); as user) {
    <app-user-details-modal
      (closeModal)="closeUserDetails()"
      [user]="user"
    ></app-user-details-modal>
  }
</div>
