<div class="mx-auto max-w-screen-2xl space-y-8 p-6">
  <div
    class="flex flex-col sm:flex-row justify-between items-start
    sm:items-center gap-4 border-b border-gray-200 pb-6"
  >
    <div>
      <h1 class="text-3xl font-bold text-gray-900">My Measurements</h1>
      <p class="text-gray-500 mt-1">Track your weight and body circumference history.</p>
    </div>

    <div class="flex flex-col sm:flex-row gap-3 w-full sm:w-auto">
      <button
        (click)="openAddForm()"
        class="inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-lg shadow-sm
        text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700
        focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500
        transition-colors hover:cursor-pointer"
        type="button"
      >
        <i class="fa-solid fa-plus mr-2"></i>
        <span>Add Measurement</span>
      </button>

      <button
        (click)="openEditRecentForm()"
        [disabled]="!(latestMeasurement())"
        class="inline-flex items-center justify-center px-4 py-2 rounded-lg shadow-sm
        text-sm font-medium border border-gray-300 bg-white text-gray-700
        hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500
        disabled:opacity-50 disabled:cursor-not-allowed transition-colors hover:cursor-pointer"
        type="button"
      >
        <i class="fa-solid fa-pen-to-square mr-2"></i>
        <span>Edit Recent</span>
      </button>
    </div>
  </div>

  @if (showForm()) {
    <app-measurement-form
      (cancelled)="closeForm()"
      (success)="onFormSuccess()"
      [initialMeasurement]="editingMeasurement()"
    />
  }

  @if (bmi() !== null) {
    <div class="rounded-xl border border-gray-200 bg-white p-6 shadow-sm">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-sm font-medium text-gray-500 uppercase tracking-wide">Body Mass Index</h2>
          <p class="mt-1 text-3xl font-bold text-gray-900">{{ bmi() }}</p>
        </div>
        <span
          [class]="bmiCategory() === 'Normal weight' ? 'bg-green-100 text-green-800' :
                   bmiCategory() === 'Underweight' ? 'bg-yellow-100 text-yellow-800' :
                   bmiCategory() === 'Overweight' ? 'bg-orange-100 text-orange-800' :
                   'bg-red-100 text-red-800'"
          class="inline-flex items-center rounded-full px-3 py-1 text-sm font-medium"
        >
          {{ bmiCategory() }}
        </span>
      </div>
    </div>
  }

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    @for (type of measurementTypes; track type.key) {
      <app-measurement-chart-card
        [measurementHistory]="historyData() ?? []"
        [measurementType]="type"
      />
    }
  </div>
</div>
