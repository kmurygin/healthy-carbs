<section class="mx-auto max-w-7xl">
  @if (isLoading()) {
  } @else if (errorMessage()) {
    <app-error-message [message]="errorMessage()!"/>
  } @else if (!recipe()) {
    <app-error-message message="Recipe not found"/>
  } @else {

    @let selectedRecipe = recipe()!;

    <div class="px-4 py-6">
      <div class="flex items-center gap-3">
        <h1 class="text-3xl font-bold">{{ selectedRecipe.name }}</h1>

        <button
          (click)="toggleFavourite()"
          [attr.aria-label]="selectedRecipe.isFavourite ? 'Remove from favourites' : 'Add to favourites'"
          [attr.aria-pressed]="selectedRecipe.isFavourite"
          class="text-2xl transition-transform duration-200 hover:scale-125 hover:cursor-pointer"
          type="button"
        >
          @if (selectedRecipe.isFavourite) {
            <i class="fa-solid fa-star text-yellow-400"></i>
          } @else {
            <i class="fa-regular fa-star text-gray-400 hover:text-yellow-400"></i>
          }
        </button>
      </div>

      @if (selectedRecipe.description) {
        <p class="mt-2 text-lg text-gray-700">
          {{ selectedRecipe.description }}
        </p>
      }
    </div>

    <div class="px-4 pb-6">
      <div class="flex flex-wrap gap-2">
        <span [class]="dietTagClasses()">
          <i [class]="dietIconClasses()"></i>
          {{ formatEnum(selectedRecipe.dietType) }}
        </span>
        <span [class]="mealTagClasses()">
          <i class="fa-solid fa-plate-wheat"></i>
          {{ formatEnum(selectedRecipe.mealType) }}
        </span>
      </div>

      <div class="mt-3 border-t border-gray-200 pt-4">
        <div class="grid grid-cols-4 gap-3 mt-3 w-full">
          @for (nutrient of macros(); track nutrient.label) {
            <div class="flex items-center justify-center gap-2">
              <i
                [class]="'fa-solid ' + nutrient.icon + ' ' + nutrient.style + ' text-lg'"
              ></i>
              <span class="hidden md:inline text-gray-600">{{ nutrient.label }}</span>
              <span class="font-semibold text-gray-900">
                {{ nutrient.value | number: '1.0-0' }} {{ nutrient.unit }}
              </span>
            </div>
          }
        </div>
      </div>

      <div class="mt-6 border-t border-gray-200 pt-6 grid grid-cols-1 lg:grid-cols-6 gap-8">

        <div class="lg:col-span-2">
          <h2 class="text-xl font-semibold flex items-center gap-2">
            <i class="fa-solid fa-carrot text-gray-400"></i>
            Ingredients
          </h2>
          <ul class="mt-3 space-y-2">
            @for (recipeIngredient of selectedRecipe.ingredients; track recipeIngredient.id) {
              <li class="flex justify-between items-baseline gap-4 py-1 border-b border-gray-100">
                <span class="text-gray-800">
                  {{ recipeIngredient.ingredient.name }}
                </span>
                <span class="text-gray-600 text-right flex-shrink-0">
                  {{ recipeIngredient.quantity | number: '1.0-2' }}
                  @if (recipeIngredient.ingredient.unit) {
                    {{ recipeIngredient.ingredient.unit }}
                  } @else {
                    {{ recipeIngredient.quantity === 1 ? 'item' : 'items' }}
                  }
                </span>
              </li>
            }
          </ul>
        </div>

        <div class="lg:col-span-4">
          <h2 class="text-xl font-semibold flex items-center gap-2">
            <i class="fa-solid fa-list-check text-gray-400"></i>
            Instructions
          </h2>
          @if (instructionSteps().length !== 0) {
            <ol class="list-decimal marker:text-emerald-700 ms-5 space-y-2 mt-4">
              @for (step of instructionSteps(); track i; let i = $index) {
                <li class="text-gray-800 leading-relaxed">
                  {{ step }}
                </li>
              }
            </ol>
          }
        </div>

      </div>
    </div>
  }
</section>
