<section class="mx-auto max-w-7xl px-4 py-6">

  <app-recipe-filter
    (filterChange)="handleFiltersChange($event)" [dietTypes]="dietTypes()"
    [mealTypes]="mealTypes()"
    [sortOptions]="sortOptions"
  />

  <div class="mb-4 flex flex-row items-center justify-between gap-3">

    <div class="flex flex-row items-center gap-3">
      <app-page-size-selector
        (pageSizeChange)="handlePageSizeChange($event)"
        [pageSizeOptions]="pageSizeOptions"
        [pageSize]="pageSize()"
      />

      <app-recipe-count-info
        [endIndex]="endIndex()"
        [startIndex]="startIndex()"
        [totalRecipeCount]="totalRecipeCount()"
      />

    </div>

    <div>
      <app-favourite-recipes-toggle
        (onlyFavouritesChange)="handleOnlyFavouritesChange($event)"
        [onlyFavourites]="onlyFavourites()"
      />
    </div>

  </div>

  @if (isLoading()) {
    <div class="flex flex-col items-center justify-center gap-2 p-12 text-gray-500">
      <i class="fa-solid fa-spinner fa-spin text-2xl text-emerald-600"></i>
      <p aria-live="polite" class="font-medium">Loading recipesâ€¦</p>
    </div>
  } @else if (errorMessage()) {
    <app-error-message
      [message]="errorMessage()!"
    />
  } @else if (!pageItems().length) {
    <app-info-message message="No recipes match your filters."/>
  } @else {
    <ul class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      @for (recipe of pageItems(); track recipe.id) {
        <app-recipe-card
          (favouriteToggled)="handleFavouriteToggle($event)"
          [recipe]="recipe"
        />
      }
    </ul>

    <app-pagination-controls
      (nextPage)="nextPage()"
      (previousPage)="prevPage()"
      [pageNumber]="pageNumber()"
      [totalPages]="totalPages()"
    />

  }
</section>
