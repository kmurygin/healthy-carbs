databaseChangeLog:
  - changeSet:
      id: add-shopping-list
      author: kmurygin
      changes:
        - sql:
            sql: |
              CREATE TABLE shopping_lists (
                  id BIGSERIAL NOT NULL,
                  meal_plan_id BIGINT NOT NULL,
                  CONSTRAINT pk_shopping_lists PRIMARY KEY (id),
                  CONSTRAINT uc_shopping_lists_meal_plan UNIQUE (meal_plan_id),
                  CONSTRAINT fk_shopping_list_to_meal_plan FOREIGN KEY (meal_plan_id) REFERENCES meal_plans (id)
              );
              
              CREATE TABLE shopping_list_items (
                  id BIGSERIAL NOT NULL,
                  shopping_list_id BIGINT NOT NULL,
                  ingredient_id BIGINT NOT NULL,
                  total_quantity DOUBLE PRECISION NOT NULL,
                  is_bought BOOLEAN NOT NULL DEFAULT FALSE,
                  CONSTRAINT pk_shopping_list_items PRIMARY KEY (id),
                  CONSTRAINT fk_item_to_shopping_list FOREIGN KEY (shopping_list_id) REFERENCES shopping_lists (id),
                  CONSTRAINT fk_item_to_ingredient FOREIGN KEY (ingredient_id) REFERENCES ingredients (id)
              );